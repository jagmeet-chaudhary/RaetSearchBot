using Microsoft.Bot.Builder.Dialogs;
using Microsoft.Bot.Connector;
using SearchBot.Extensions;
using SearchBot.Model;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Linq;
using System.Web;

namespace SearchBot.UI
{
    public class CardActionValues
    {
        public string ButtonLabel;
        public string ButtonValue;
        public string ActionType;
        public string responseImage;

    }
    public static class UIHelper
    {
        public static Attachment CreateHeroCard(string title, string subtitle, string responseMsgOnly, List<CardActionValues> cardActionValues)
        {
            var heroCard = new ThumbnailCard
            {
                Title = title,
                Subtitle = subtitle,
                Text = responseMsgOnly,

            };
            var cardImages = new List<CardImage>();
            var cardActions = new List<CardAction>();
            foreach (var cardActionValue in cardActionValues)
            {
                cardImages.Add(new CardImage(cardActionValue.responseImage));
                cardActions.Add(new CardAction(cardActionValue.ActionType, cardActionValue.ButtonLabel, value: cardActionValue.ButtonValue, image: cardActionValue.responseImage));
            }
            heroCard.Images = cardImages;
            heroCard.Buttons = cardActions;
            return heroCard.ToAttachment();
        }

        public static Attachment CreateThumbnailCard(string title, List<CardActionValues> cardActionValues, TaskDto taskDto,IDialogContext context)
        {
            Attachment plAttachment = new Attachment();
            var image = taskDto.UserImage ?? "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";
            List<CardImage> cardImages = new List<CardImage>();
            cardImages.Add(new CardImage(url: $"data:image/png;base64,{image}"));

            var baseUrl = ConfigurationManager.AppSettings["UiAppUrl"];
            

            List<CardAction> cardButtons = new List<CardAction>();

            CardAction plButton = new CardAction()
            {
                Value = $"{baseUrl}home/{taskDto.ProcessId}/{taskDto.Id}",
                Type = "openUrl",
                Title = "Click To View".ToUserLocale(context)
            };

            cardButtons.Add(plButton);

            ThumbnailCard plCard = new ThumbnailCard()
            {
                Title = $"{taskDto.ProcessFullName} for".ToUserLocale(context),
                Subtitle = $"{taskDto.ProcessSubjectFullName}",
                Images = cardImages,
                Buttons = cardButtons
            };

            plAttachment = plCard.ToAttachment();

            return plAttachment;
        }

    }
}